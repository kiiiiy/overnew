<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>익명 토론방</title>
</head>
<body>

<h1>익명 토론방 목록</h1>

<!-- 실명 토론방 이동 버튼 -->
<p>
    <a href="{% url 'discussion:discussion_list' selected_category.nc_id %}">
        <button type="button">실명 토론방 보기</button>
    </a>
</p>

<hr>

<!-- 카테고리 선택 -->
<h3>카테고리</h3>

{% for category in categories %}
    <a href="{% url 'discussion:anonymous_list' category.nc_id %}">
        <button type="button">
            {{ category.news_category }}
            {% if selected_category.nc_id == category.nc_id %}(선택됨){% endif %}
        </button>
    </a>
{% endfor %}

<hr>

<!-- 익명 토론방 리스트 -->
<h3>"{{ selected_category.news_category }}" 익명 토론방 목록</h3>

{% if rooms %}
    <ul>
        {% for room in rooms %}
            {% with article=room.article %}
            <li>
                <h4>
                    {% if article.url %}
                        <a href="{{ article.url }}" target="_blank">
                            {{ article.title }}
                        </a>
                    {% else %}
                        {{ article.title }}
                    {% endif %}
                </h4>

                <p>
                    매체:
                    {% if article.media %}
                        {{ article.media.media_name }}
                    {% else %}(알 수 없음){% endif %}
                    <br>
                    기사 작성일: {{ article.created_at|date:"Y-m-d H:i" }}<br>
                    토의 시작: {{ room.start_time|date:"Y-m-d H:i" }}
                    {% if room.finish_time %}
                        ~ {{ room.finish_time|date:"Y-m-d H:i" }}
                    {% endif %}
                    | 익명 방
                </p>

                {% if article.summary %}
                    <p>{{ article.summary }}</p>
                {% else %}
                    <p>{{ article.news_content|truncatechars:100 }}</p>
                {% endif %}
            </li>
            {% endwith %}
        {% endfor %}
    </ul>
{% else %}
    <p>익명 토론방이 없습니다.</p>
{% endif %}

</body>
</html>
